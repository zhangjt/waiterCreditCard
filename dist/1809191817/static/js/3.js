webpackJsonp([3,13],{"1EH/":function(t,e,a){var r=a("PV/C");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("528e9cac",r,!0)},CfVK:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("w/ed"),n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detailOrUpdate"},[a("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"180px"}},[a("el-form-item",{attrs:{label:"导入时间",prop:"importDate"}},[a("el-input",{attrs:{placeholder:"导入时间",disabled:""},model:{value:t.dataForm.importDate,callback:function(e){t.$set(t.dataForm,"importDate",e)},expression:"dataForm.importDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"财喵账号",prop:"account"}},[a("el-input",{attrs:{placeholder:"财喵账号",disabled:t.disabled},model:{value:t.dataForm.account,callback:function(e){t.$set(t.dataForm,"account",e)},expression:"dataForm.account"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"登记账号",prop:"creditAccount"}},[a("el-input",{attrs:{placeholder:"登记账号",maxlength:"20",disabled:t.disabled},model:{value:t.dataForm.creditAccount,callback:function(e){t.$set(t.dataForm,"creditAccount",e)},expression:"dataForm.creditAccount"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"登记时间",prop:"recordDate"}},[a("el-input",{attrs:{placeholder:"登记时间",maxlength:"4",disabled:""},model:{value:t.dataForm.recordDate,callback:function(e){t.$set(t.dataForm,"recordDate",e)},expression:"dataForm.recordDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"银行/信用卡名称",prop:"bankName"}},[a("el-input",{attrs:{placeholder:"银行/信用卡名称",maxlength:"8",disabled:t.disabled},model:{value:t.dataForm.bankName,callback:function(e){t.$set(t.dataForm,"bankName",e)},expression:"dataForm.bankName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"银行注册号码",prop:"phone"}},[a("el-input",{attrs:{placeholder:"银行注册号码",maxlength:"8",disabled:t.disabled},model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"返利金额(元)",prop:"rebate"}},[a("el-input",{attrs:{placeholder:"返利金额(元)",maxlength:"8",disabled:t.disabled},model:{value:t.dataForm.rebate,callback:function(e){t.$set(t.dataForm,"rebate",e)},expression:"dataForm.rebate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"review"}},[a("el-input",{attrs:{placeholder:"备注",disabled:t.disabled},model:{value:t.dataForm.review,callback:function(e){t.$set(t.dataForm,"review",e)},expression:"dataForm.review"}})],1)],1),t._v(" "),a("div",{staticStyle:{"margin-left":"20%"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"编辑"==t.title,expression:"title=='编辑'"}],attrs:{type:"primary"},on:{click:function(e){t.dataFormSubmit()}}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:function(e){t.returnList()}}},[t._v("返回")])],1)],1)},staticRenderFns:[]};var i=function(t){a("1EH/")},l=a("VU/8")(r.a,n,!1,i,null,null);e.default=l.exports},"PV/C":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.detailOrUpdate .title {\n  font-size: 16px;\n}\n.detailOrUpdate .el-form-item__content {\n  width: 50%;\n}\n",""])},kyCG:function(t,e,a){var r=a("lVV7");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("2236e6e9",r,!0)},lVV7:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.hidden {\n  display: none;\n}\n",""])},qnfv:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("CfVK"),n=a("0xDb"),i={data:function(){return{dataForm:{startImportDate:"",endImportDate:"",bankName:"",account:"",status:""},dataList:[],pageIndex:1,pageSize:20,totalPage:0,dataListLoading:!1,dataListSelections:[],detailOrUpdateVisible:!1,downloadUrl:"",downloadRebateUrl:"",excelUrl:"",dateTime:[]}},components:{DetailOrUpdate:r.default},activated:function(){this.getDataList()},methods:{setDateTime:function(t){t?(this.dataForm.startImportDate=Object(n.b)(t[0]),this.dataForm.endImportDate=Object(n.b)(t[1])):(this.dataForm.startImportDate="",this.dataForm.endImportDate="")},getDataList:function(t){var e=this;this.dataListLoading=!0,this.detailOrUpdateVisible=!1,this.$http({url:this.$http.adornUrl("/creditCardRecord/getList"),method:"post",params:this.$http.adornParams({page:"1"==t?"1":this.pageIndex,limit:this.pageSize,startImportDate:this.dataForm.startImportDate,endImportDate:this.dataForm.endImportDate,bankName:this.dataForm.bankName,account:this.dataForm.account,status:this.dataForm.status})}).then(function(t){var a=t.data;a&&0===a.code?(e.dataList=a.page.list,e.totalPage=a.page.totalNum):(e.dataList=[],e.totalPage=0),e.dataListLoading=!1})},sizeChangeHandle:function(t){this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(t){this.pageIndex=t,this.getDataList()},selectionChangeHandle:function(t){this.dataListSelections=t},detailOrUpdateHandle:function(t,e,a){var r=this;this.detailOrUpdateVisible=!0,this.$nextTick(function(){r.$refs.detailOrUpdate.init(t,e,a)})},grantHandle:function(){var t=this,e=this.dataListSelections.map(function(t){return t.id});e=e.join(",");var a=this.dataListSelections.map(function(t){return t.status});console.log(a);for(var r=0;r<a.length;r++)if("1"==a[r])return void this.$alert("您选择了含有已发放的记录，请先取消勾选再操作","提示",{confirmButtonText:"确定"});this.$confirm("是否确定发放?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl("/creditCardRecord/rebate"),method:"post",data:t.$http.adornData({ids:e},!1,"form")}).then(function(e){var a=e.data;a&&0===a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.getDataList()}}):t.$message.error(a.msg)})}).catch(function(){})},downloadHandle:function(){var t=this,e=this.$cookie.get("token"),a=this.$http.adornUrl("fetchdata/creditcard/downExcel");this.downloadUrl=a+"?token="+e,this.$nextTick(function(){t.$refs.downloadBtn.click()})},selExcelFile:function(t){var e=this,a=t.target.files[0];if(void 0===a||a.size<=0)alert("请选择文件");else{var r=new FormData;r.append("action","UploadVMKImagePath"),r.append("file",a);var n=r,i=this.$cookie.get("token");this.$http({url:this.$http.adornUrl("fetchdata/creditcard/importData"),cache:!1,processData:!1,contentType:!1,method:"post",data:n}).then(function(t){var a=t.data;e.$refs.importExecl.value="",a&&0===a.code?e.$alert('数据匹配完成<br /><br /><a class="primary" style="margin-left:45px;" href="'+a.file+"?token="+i+'">导出查看</a>',"提示",{dangerouslyUseHTMLString:!0}):e.$alert(a.msg+'<br /><br /><a class="primary" style="margin-left:45px;" href="'+a.file+"?token="+i+'">下载查看</a>',"提示",{dangerouslyUseHTMLString:!0})})}},importHandle:function(){this.$refs.importExecl.click()},exportExcelHandle:function(){var t=this,e=this.$cookie.get("token"),a=this.$http.adornUrl("creditCardRecord/exportData");this.excelUrl=a+"?startImportDate="+this.dataForm.startImportDate+"&endImportDate="+this.dataForm.endImportDate+"&bankName="+this.dataForm.bankName+"&account="+this.dataForm.account+"&status="+this.dataForm.status+"&token="+e,this.$nextTick(function(){t.$refs.excelBtn.click()})},downloadRebateHandle:function(){var t=this,e=this.$cookie.get("token"),a=this.$http.adornUrl("creditCardRecord/downloadTemlete");this.downloadRebateUrl=a+"?token="+e,this.$nextTick(function(){t.$refs.downloadRebateBtn.click()})},selRebateExcelFile:function(t){var e=this,a=t.target.files[0];if(void 0===a||a.size<=0)alert("请选择文件");else{var r=new FormData;r.append("action","UploadVMKImagePath"),r.append("file",a);var n=r,i=this.$cookie.get("token");this.$http({url:this.$http.adornUrl("creditCardRecord/importData"),cache:!1,processData:!1,contentType:!1,method:"post",data:n}).then(function(t){var a=t.data;e.$refs.importExecl.value="",a&&0===a.code?e.$message({message:"上传成功",type:"success",duration:1500,onClose:function(){e.getDataList()}}):e.$alert(a.msg+'<br /><br /><a class="primary" style="margin-left:45px;" href="'+a.file+"?token="+i+'">下载查看</a>',"提示",{dangerouslyUseHTMLString:!0})})}},importRebateHandle:function(){this.$refs.importRebateExecl.click()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-user"},[t.detailOrUpdateVisible?a("detail-or-update",{ref:"detailOrUpdate",on:{refreshDataList:t.getDataList}}):a("div",[a("el-form",{staticStyle:{"margin-bottom":"15px"},attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.getDataList("1")}}},[a("el-form-item",{attrs:{label:"导入时间"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间"},on:{change:t.setDateTime},model:{value:t.dateTime,callback:function(e){t.dateTime=e},expression:"dateTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"银行/信用卡名称"}},[a("el-input",{attrs:{placeholder:"银行/信用卡名称",clearable:""},model:{value:t.dataForm.bankName,callback:function(e){t.$set(t.dataForm,"bankName",e)},expression:"dataForm.bankName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"财喵账号"}},[a("el-input",{attrs:{placeholder:"财喵账号",clearable:""},model:{value:t.dataForm.account,callback:function(e){t.$set(t.dataForm,"account",e)},expression:"dataForm.account"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"发放状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择状态"},on:{change:function(e){t.getDataList("1")}},model:{value:t.dataForm.status,callback:function(e){t.$set(t.dataForm,"status",e)},expression:"dataForm.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"待发放",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"已发放",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"发放失败",value:"2"}})],1)],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.getDataList("1")}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"success",disabled:t.dataListSelections.length<=0},on:{click:function(e){t.grantHandle()}}},[t._v("发放")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.downloadHandle()}}},[t._v("银行数据模板下载")]),t._v(" "),a("a",{ref:"downloadBtn",staticClass:"hidden",attrs:{href:t.downloadUrl,download:"银行数据模板下载.xlsx"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.importHandle()}}},[t._v("导入银行数据")]),t._v(" "),a("input",{ref:"importExecl",staticClass:"hidden",attrs:{type:"file"},on:{change:function(e){t.selExcelFile(e)}}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.downloadRebateHandle()}}},[t._v("申请数据模板下载")]),t._v(" "),a("a",{ref:"downloadRebateBtn",staticClass:"hidden",attrs:{href:t.downloadRebateUrl,download:"申请数据模板下载.xlsx"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.importRebateHandle()}}},[t._v("导入excel")]),t._v(" "),a("input",{ref:"importRebateExecl",staticClass:"hidden",attrs:{type:"file"},on:{change:function(e){t.selRebateExcelFile(e)}}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.exportExcelHandle()}}},[t._v("导出excel")]),t._v(" "),a("a",{ref:"excelBtn",staticClass:"hidden",attrs:{href:t.excelUrl,download:"信用卡申请记录列表.xlsx"}})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,border:""},on:{"selection-change":t.selectionChangeHandle}},[a("el-table-column",{attrs:{type:"index",label:"序号","header-align":"center",align:"center",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id","header-align":"center",align:"center",width:"60",label:"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"importDate","header-align":"center",align:"center",label:"导入时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"applyDate","header-align":"center",align:"center",label:"申请时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"account","header-align":"center",align:"center",label:"财喵账号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"creditAccount","header-align":"center",align:"center",label:"登记账号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"recordDate","header-align":"center",align:"center",label:"登记时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"bankName","header-align":"center",align:"center",label:"银行/信用卡名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone","header-align":"center",align:"center",label:"银行注册号码"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rebate","header-align":"center",align:"center",width:"70",label:"返利金额(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("formalMoney")(e.row.rebate))+"\n      ")]}}])},[t._v("filter\n      ")]),t._v(" "),a("el-table-column",{attrs:{prop:"status","header-align":"center",align:"center",width:"90",label:"发放状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("el-tag",{attrs:{size:"small",type:"warning"}},[t._v("待发放")]):1===e.row.status?a("el-tag",{attrs:{size:"small",type:"success"}},[t._v("已发放")]):a("el-tag",{attrs:{size:"small",type:"danger"}},[t._v("发放失败")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"operator","header-align":"center",align:"center",width:"100",label:"操作员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"review","header-align":"center",align:"center",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",width:"150",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.row.status||2==e.row.status,expression:"scope.row.status==0||scope.row.status==2"}],attrs:{type:"success",size:"mini"},on:{click:function(a){t.detailOrUpdateHandle(e.row.id,e.row,"true")}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){t.detailOrUpdateHandle(e.row.id,e.row,"false")}}},[t._v("详情")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}})],1)],1)},staticRenderFns:[]};var o=a("VU/8")(i,l,!1,function(t){a("kyCG")},null,null);e.default=o.exports},"w/ed":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__);__webpack_exports__.a={data:function(){return{title:null,disabled:!0,dataForm:{id:0,importDate:"",account:"",creditAccount:"",recordDate:"",bankName:"",phone:"",rebate:"",review:""},dataRule:{account:[{required:!0,message:"财喵账号不能为空",trigger:"blur"}],creditAccount:[{required:!0,message:"登记账号不能为空",trigger:"blur"}],bankName:[{required:!0,message:"银行/信用卡名称不能为空",trigger:"blur"}],phone:[{required:!0,message:"银行注册号码不能为空",trigger:"blur"}],rebate:[{required:!0,message:"返利金额不能为空",trigger:"blur"}]}}},methods:{init:function(t,e,a){this.dataForm.id=t||0,this.title="true"==a?"编辑":"详情",this.dataForm.id&&(this.dataForm=e,this.dataForm.rebate=e.rebate/100),this.disabled="true"!=a},returnList:function(){this.$emit("refreshDataList")},dataFormSubmit:function dataFormSubmit(){var _this=this;this.$refs.dataForm.validate(function(valid){if(valid){if(_this.dataForm.rebate<0)return void _this.$alert("您输入的返利金额不能小于0","提示",{confirmButtonText:"确定"});var params=eval("("+(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(_this.dataForm)+__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()({rebate:Math.round(100*_this.dataForm.rebate)})).replace(/}{/,",")+")");_this.$http({headers:{"Content-Type":"application/json; charset=utf-8"},url:_this.$http.adornUrl("/creditCardRecord/edit"),method:"post",data:_this.$http.adornData(params,!1)}).then(function(t){var e=t.data;e&&0===e.code?_this.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){_this.$emit("refreshDataList")}}):_this.$message.error(e.msg)})}})}}}}});